@model MedicalCenterRegistration.Models.ViewModels.CreateVisitViewModel


<form asp-action="Create" class="p-2 p-sm-5">
    <h1>Wybierz lekarza oraz termin:</h1>

    <input hidden name="PatientId" value="@ViewData["PatientId"]"/>
    <div class="row">
        <div class="col-xl-6 list-group">
            <label style="gap: 12px;" id="DoctorId1Label" class="list-group-item list-group-item-action d-flex">
                <div style="height: 100px; width: 100px; min-width: 100px" class="rounded overflow-hidden">
                    <img style="object-fit: cover;" class="w-100 h-100" src="~/assets/doctors/adam.jpg" />
                </div>
                <div>
                    <input hidden type="radio" name="DoctorId" value="1" required />
                    <div class="d-flex flex-column flex-sm-row justify-content-between w-100 mb-1 align-items-start align-items-sm-center">
                        <div class="d-flex align-items: center">
                            <h5 class="m-0 me-2">Adam Jankowski</h5>
                            <span style="top: 1px;" class="position-relative text-muted">32 lata</span>
                        </div>

                        <span class="badge rounded-pill bg-success mt-1 mt-sm-0">Darmowa wizyta</span>
                    </div>
                    <p class="mb-1">
                        doświadczony lekarz specjalizujący się w kompleksowej opiece medycznej.
                        Specjalista w zakresie diagnostyki i leczenia schorzeń układu oddechowego.
                    </p>
                </div>
            </label>
            <label style="gap: 12px;" id="DoctorId2Label" class="list-group-item list-group-item-action d-flex">
                <div style="height: 100px; width: 100px; min-width: 100px" class="rounded overflow-hidden">
                    <img style="object-fit: cover;" class="w-100 h-100" src="~/assets/doctors/iga.jpg" />
                </div>
                <div>
                    <input hidden type="radio" name="DoctorId" value="2" required />
                    <div class="d-flex flex-column flex-sm-row justify-content-between w-100 mb-1 align-items-start align-items-sm-center">
                        <div class="d-flex align-items: center">
                            <h5 class="m-0 me-2">Iga Kraśko</h5>
                            <span style="top: 1px;" class="position-relative text-muted">32 lata</span>
                        </div>

                        <span class="badge rounded-pill bg-success mt-1 mt-sm-0">Darmowa wizyta</span>
                    </div>
                    <p class="mb-1">
                        doświadczony lekarz specjalizujący się w kompleksowej opiece medycznej.
                        Specjalista w zakresie diagnostyki i leczenia schorzeń układu oddechowego.
                    </p>
                </div>
            </label>
        </div>
        <div id="calendar" class="col-xl-6 mt-4 mt-xl-0"></div>
        <input hidden id="calendar-input" name="Date" />
    </div>

    <div class="mt-5">
        <h2>Godzina:</h2>
        <div class="time-picker disabled">
            <div class="row">
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot selected">06:00</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">06:30</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">07:00</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">07:30</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">08:00</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">08:30</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">09:00</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">09:30</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">10:00</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">10:30</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">11:00</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">11:30</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">12:00</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">12:30</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">13:00</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">13:30</div>
                </div>

                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">14:00</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">14:30</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">15:00</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <div class="time-picker__time-slot">15:30</div>
                </div>
                <div class="col-4 col-md-3 col-lg-2">
                    <label class="time-picker__time-slot">
                        <input hidden type="radio" name="Time" value="16:00" />
                        16:00
                    </label>
                </div>
            </div>
        </div>

    </div>

    <div class="d-flex justify-content-center mt-5">
        <button id="confirmVisitBtn" style="padding: 8px 64px !important;"  type="submit" class="btn btn-primary">Potwierdź wizytę</button>
    </div>
</form>

@* 
  @section Scripts {
      @{
          await Html.RenderPartialAsync("_ValidationScriptsPartial");
      }
  } *@

<script>

    document.addEventListener('DOMContentLoaded', function () {
        var calendarEl = document.getElementById('calendar');
        var calendarInput = document.getElementById('calendar-input');
        var selectedDate = null;

        calendarEl.classList.add('calendar__disabled')

        var timePicker = document.querySelector('.time-picker');


        var calendar = new FullCalendar.Calendar(calendarEl, {
            themeSystem: 'bootstrap5',
            initialView: 'dayGridMonth',
            locale: 'plLocale',
            firstDay: 1,
            validRange: () => ({ start: new Date(), end: new Date(new Date().setMonth(new Date().getMonth() + 12)) }), // able to register 12 months from now tops
            buttonText: {
                today: 'Dzisiaj'
            },
            dateClick: function (info) {
                if (selectedDate) {
                    selectedDate.classList.remove('calendar__selected');
                }

                selectedDate = calendarEl.querySelector('[data-date="' + info.dateStr + '"]');
                if (selectedDate) {
                    selectedDate.classList.add('calendar__selected');
                    timePicker.classList.remove('disabled');
                    calendarInput.value = info.dateStr;
                }
            }
        });
        calendar.render();


        const doctors = document.querySelectorAll('input[name="DoctorId"]');
        doctors.forEach(option => {
            option.addEventListener('change', function () {

                calendarEl.classList.remove('calendar__disabled')
                const selectedValue = this.value;
                const optionLabel = document.getElementById(`${this.name}${this.value}Label`)
                optionLabel.classList.add('active');

                const allLabels = document.querySelectorAll('.list-group-item');
                allLabels.forEach(label => {
                    if (label !== optionLabel) {
                        label.classList.remove('active');
                    }
                });
            });
        });


        const timeOptions = document.querySelectorAll('.time-picker__time-slot');
        timeOptions.forEach(option => {
            option.addEventListener('click', function () {
                timeOptions.forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
            });
        });

    });



</script>



